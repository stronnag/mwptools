
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Mission Planner, Ground Control Station, Log Replay">
      
      
        <meta name="author" content="Jonathan Hudson">
      
      
      
        <link rel="prev" href="../mwp_support/">
      
      
        <link rel="next" href="../licence-misc-info/">
      
      
      <link rel="icon" href="../images/mwp_icon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>mwp miscellaneous tools - mwptools</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/extra.css">
    
      <link rel="stylesheet" href="../assets/pdf.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#mwp-miscellaneous-tools" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="mwptools" class="md-header__button md-logo" aria-label="mwptools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            mwptools
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              mwp miscellaneous tools
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/stronnag/mwptools/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Github
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="mwptools" class="md-nav__button md-logo" aria-label="mwptools" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    mwptools
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/stronnag/mwptools/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Github
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Home
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Home
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp_support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help and Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-Gtk4-migration-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Migration Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../running/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Running mwp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User interface
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../dock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Side Bar Concepts and Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mission-editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mission Editor
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../gcs-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ground Control Station Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../replay-tools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Replay Tools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../misc-ui-elements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Miscellaneous UI Elements
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-terrain-avoidance-quick-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Terrain Avoidance Quick Guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Mission-Elevation-Plot-and-Terrain-Analysis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mission Elevations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-los-tool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Line of Sight (LOS) Tool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-multi-procotol/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    "Serial" device support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-Configuration/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mwp Configuration
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-safehomes-editor/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Safehome and Auto-land
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-geozones/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mwp and Geozones
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-Radar-View/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Radar View
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-telemetry-tracker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Telemetry Tracking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-area-planner/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mwp Survey Planner
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp_video_player/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Playing Video in mwp
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-text-to-speech/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mwp text to speech
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Fly-By-Home-waypoints-%28inav-4-new-feature%29/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fly By Home Waypoints
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Black-Ops/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Anonymous Maps
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-follow-me/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mwp Follow Me
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Build and Install / OS Specific
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Build and Install / OS Specific
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Building-with-meson-and-ninja/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build / install mwp (Generic)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-macos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    MacOS (Homebrew)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-windows-msys/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows (MSys2)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Miscellaneous
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Miscellaneous
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-Power-and-screen-management/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Power and screen management
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inav-4.0-multi-missions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    INAV 4.0 Multi-Mission Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mqtt---bulletgcss-telemetry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BulletGCSS Telemetry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Support-for-inav-3.0-WP-features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mwp and INAV 3.0 Mission Updates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Replaying-Ardupilot-logs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ardupilot log replay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp-Dbus-API/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DBus API
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mwp_support/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Help and Support
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    mwp miscellaneous tools
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    mwp miscellaneous tools
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fc-get-fc-set" class="md-nav__link">
    <span class="md-ellipsis">
      fc-get, fc-set
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashsh-fcflash" class="md-nav__link">
    <span class="md-ellipsis">
      flash.sh, fcflash
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flash.sh, fcflash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operation" class="md-nav__link">
    <span class="md-ellipsis">
      Operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    <span class="md-ellipsis">
      Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flash-image-dfu-auto-detect" class="md-nav__link">
    <span class="md-ellipsis">
      Flash image, DFU, auto-detect
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flash-image-usb-serial-devttyusb0-auto-detect" class="md-nav__link">
    <span class="md-ellipsis">
      Flash image, USB serial (/dev/ttyUSB0), auto-detect
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flash-image-rescue-mode-hardware-boot-button-full-flash-erase" class="md-nav__link">
    <span class="md-ellipsis">
      Flash image, rescue mode (hardware boot button), full flash erase
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashgo" class="md-nav__link">
    <span class="md-ellipsis">
      flashgo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flashgo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-flash-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Check flash usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-mode-download-whole-flash" class="md-nav__link">
    <span class="md-ellipsis">
      Test mode (download whole flash)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-flash-info" class="md-nav__link">
    <span class="md-ellipsis">
      Check flash info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-to-auto-generated-file-name" class="md-nav__link">
    <span class="md-ellipsis">
      Download to auto-generated file name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erase-the-flash-only-no-download" class="md-nav__link">
    <span class="md-ellipsis">
      Erase the flash (only, no download)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-flash-info_1" class="md-nav__link">
    <span class="md-ellipsis">
      Check flash info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-to-nominated-file-name" class="md-nav__link">
    <span class="md-ellipsis">
      Download to nominated file name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-to-nominated-file-and-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Download to nominated file and directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-to-auto-generated-file-name-and-nominated-directory-then-erase-flash" class="md-nav__link">
    <span class="md-ellipsis">
      Download to auto-generated file name and nominated directory, then erase flash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flash_dumprb" class="md-nav__link">
    <span class="md-ellipsis">
      flash_dump.rb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cliterm" class="md-nav__link">
    <span class="md-ellipsis">
      cliterm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blackbox-analysis-and-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      Blackbox analysis and diagnostics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Blackbox analysis and diagnostics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#worked-example" class="md-nav__link">
    <span class="md-ellipsis">
      Worked example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Worked example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Script usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results-from-the-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Results from the analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similar-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Similar tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../licence-misc-info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Licence and Alternative Tools
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      Overview
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fc-get-fc-set" class="md-nav__link">
    <span class="md-ellipsis">
      fc-get, fc-set
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashsh-fcflash" class="md-nav__link">
    <span class="md-ellipsis">
      flash.sh, fcflash
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flash.sh, fcflash">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#operation" class="md-nav__link">
    <span class="md-ellipsis">
      Operation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options" class="md-nav__link">
    <span class="md-ellipsis">
      Options
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#flash-image-dfu-auto-detect" class="md-nav__link">
    <span class="md-ellipsis">
      Flash image, DFU, auto-detect
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flash-image-usb-serial-devttyusb0-auto-detect" class="md-nav__link">
    <span class="md-ellipsis">
      Flash image, USB serial (/dev/ttyUSB0), auto-detect
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#flash-image-rescue-mode-hardware-boot-button-full-flash-erase" class="md-nav__link">
    <span class="md-ellipsis">
      Flash image, rescue mode (hardware boot button), full flash erase
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flashgo" class="md-nav__link">
    <span class="md-ellipsis">
      flashgo
    </span>
  </a>
  
    <nav class="md-nav" aria-label="flashgo">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#usage-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Usage Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Usage Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#check-flash-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Check flash usage
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-mode-download-whole-flash" class="md-nav__link">
    <span class="md-ellipsis">
      Test mode (download whole flash)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-flash-info" class="md-nav__link">
    <span class="md-ellipsis">
      Check flash info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-to-auto-generated-file-name" class="md-nav__link">
    <span class="md-ellipsis">
      Download to auto-generated file name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erase-the-flash-only-no-download" class="md-nav__link">
    <span class="md-ellipsis">
      Erase the flash (only, no download)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#check-flash-info_1" class="md-nav__link">
    <span class="md-ellipsis">
      Check flash info
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-to-nominated-file-name" class="md-nav__link">
    <span class="md-ellipsis">
      Download to nominated file name
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-to-nominated-file-and-directory" class="md-nav__link">
    <span class="md-ellipsis">
      Download to nominated file and directory
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#download-to-auto-generated-file-name-and-nominated-directory-then-erase-flash" class="md-nav__link">
    <span class="md-ellipsis">
      Download to auto-generated file name and nominated directory, then erase flash
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#flash_dumprb" class="md-nav__link">
    <span class="md-ellipsis">
      flash_dump.rb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cliterm" class="md-nav__link">
    <span class="md-ellipsis">
      cliterm
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blackbox-analysis-and-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      Blackbox analysis and diagnostics
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Blackbox analysis and diagnostics">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#worked-example" class="md-nav__link">
    <span class="md-ellipsis">
      Worked example
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Worked example">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Script usage
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#results-from-the-analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Results from the analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#similar-tools" class="md-nav__link">
    <span class="md-ellipsis">
      Similar tools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="mwp-miscellaneous-tools">mwp miscellaneous tools<a class="headerlink" href="#mwp-miscellaneous-tools" title="Permanent link">#</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">#</a></h2>
<p>The <a href="https://github.com/stronnag/mwptools">mwp</a> suite contains numerous command line tools developed since 2015 in order to aid development of INAV, development of <a href="https://github.com/stronnag/mwptools">mwp</a> and diagnosing numerous (often 3rd party) problems, more so in the early days.</p>
<p>This chapter describes a few of the command line tools that are provided by mwptools. Note that not all these tools are built or installed by default; it may be necessary to enter a source directory and invoke <code>make</code> in situ, or copy a script to a directory on the <code>$PATH</code>.</p>
<h2 id="fc-get-fc-set">fc-get, fc-set<a class="headerlink" href="#fc-get-fc-set" title="Permanent link">#</a></h2>
<p><code>fc-get</code> and <code>fc-set</code> are tools to manage CLI settings:</p>
<ul>
<li><code>fc-get</code> : Dump cli <code>diff</code> settings to a file that can be replayed by <code>fc-set</code></li>
<li><code>fc-set</code> : Replay a file of cli settings to the FC. Once the settings have been saved, a backup is made of the original file; the settings are then read from the FC and the original file updated.<pre><code>$ fc-set --help
Usage:
  fc-set [OPTION?]  - fc diff manager

Help Options:
  -h, --help        Show help options

Application Options:
  -b, --baud        baud rate
  -d, --device      device
  -n, --no-back     no backup
</code></pre>
</li>
</ul>
<p>NOTE: <code>fc-get</code> and <code>fc-set</code> are essentially the same program, the function is defined by the name.</p>
<p>The tools auto-detect the plugging of an FC.</p>
<pre><code>$ fc-get /tmp/dodo-test.txt
12:16:04 No device given ... watching
12:16:04 Opening /dev/ttyUSB0
12:16:04 Establishing CLI
12:16:05 Starting "diff all"
12:16:06 Exiting
12:16:06 Rebooting
</code></pre>
<p>Then, maybe after flashing the FC to a new version:</p>
<pre><code>$ fc-set /tmp/dodo-test.txt
12:16:56 No device given ... watching
12:16:56 Opening /dev/ttyUSB0
12:16:56 Starting restore
12:16:56 Establishing CLI
12:16:58 [████████████████████████████████] 100%
12:16:58 Rebooting
12:17:01 Establishing CLI
12:17:03 Starting "diff all"
12:17:03 Exiting
12:17:03 Rebooting
</code></pre>
<p>And now we have a settings backup ...</p>
<pre><code>$ ls -l /tmp/dodo*
-rw-r----- 1 jrh jrh 2115 Mar 28 12:17 /tmp/dodo-test.txt
-rw-r----- 1 jrh jrh 2115 Mar 28 12:16 /tmp/dodo-test.txt.2018-03-28T12.17.01
</code></pre>
<h2 id="flashsh-fcflash">flash.sh, fcflash<a class="headerlink" href="#flashsh-fcflash" title="Permanent link">#</a></h2>
<p><code>fcflash</code> is a script to flash INAV images to a flight controller using the command line.
It requires that <code>stm32flash</code> and <code>dfu-util</code> are installed on your computer. Optionally, it requires GCC <code>objcopy</code> to convert hex files to binary for DFU operation.</p>
<ul>
<li>DFU mode requires <code>dfu-util</code></li>
<li>USB serial mode requires <code>stm32flash</code></li>
</ul>
<p><code>fcflash</code> decides which tool to use depending on the detected device node (which can be overridden)</p>
<ul>
<li><code>/dev/ttyACMx</code> =&gt; DFU</li>
<li><code>/dev/ttyUSBx</code> =&gt; USB serial</li>
</ul>
<p>Note: <code>fcflash</code> is the installed file, in the repository it's <code>src/samples/flash.sh</code>.</p>
<h3 id="operation">Operation<a class="headerlink" href="#operation" title="Permanent link">#</a></h3>
<p><code>fcflash</code> performs the following tasks</p>
<ul>
<li>Auto-detects the serial port (unless <code>rescue</code> is specified, and the FC is set to DFU via hardare (switch, pads))</li>
<li>Sets the serial port to a sane mode</li>
<li>Sets the FC to bootloader mode (unless 'rescue' is specified).</li>
<li>If necessary, converts the <code>hex</code> image to a <code>bin</code> image (for DFU)</li>
<li>Flashes the firmware.</li>
</ul>
<h3 id="options">Options<a class="headerlink" href="#options" title="Permanent link">#</a></h3>
<p><code>fcflash</code> parses a set of options given on the command line. Normally, only the path to the hex file is required and everything else will be detected (device, flashing mode).</p>
<ul>
<li><code>rescue</code> : Assumed the FC is already in bootloader mode, requires a device name</li>
<li><code>/dev/*</code> : The name of the serial device, required for <code>rescue</code>, typically <code>/dev/ttyACM0</code></li>
<li><code>erase</code>  : Performs full chip erase</li>
<li><code>[123456789]*</code> : Digits, representing a baud rate. <code>115200</code> is assumed by default.</li>
</ul>
<p>A file name (an INAV hex file) is also required.</p>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">#</a></h2>
<h3 id="flash-image-dfu-auto-detect">Flash image, DFU, auto-detect<a class="headerlink" href="#flash-image-dfu-auto-detect" title="Permanent link">#</a></h3>
<pre><code>fcflash inav_5.0.0_MATEKF405.hex
</code></pre>
<h3 id="flash-image-usb-serial-devttyusb0-auto-detect">Flash image, USB serial (/dev/ttyUSB0), auto-detect<a class="headerlink" href="#flash-image-usb-serial-devttyusb0-auto-detect" title="Permanent link">#</a></h3>
<p>For my broken FC (USB connector unreliable).</p>
<pre><code># as above, /dev/ttyUSB0 is autodetected
fcflash inav_5.0.0_MATEKF405.hex

# force device (and USB serial mode)
fcflash /dev/ttyUSB0 inav_5.0.0_MATEKF405.hex
</code></pre>
<h3 id="flash-image-rescue-mode-hardware-boot-button-full-flash-erase">Flash image, rescue mode (hardware boot button), full flash erase<a class="headerlink" href="#flash-image-rescue-mode-hardware-boot-button-full-flash-erase" title="Permanent link">#</a></h3>
<pre><code>fcflash rescue erase /dev/ttyACM0 inav_5.0.0_MATEKF405.hex
</code></pre>
<p>The no specific ordering of the command line options is required.</p>
<p>In summary, the command:</p>
<pre><code>fcflash inav_5.0.0_WINGFC.hex
</code></pre>
<p>results in</p>
<ul>
<li>The hex is converted to a temporary Intel binary format file, as required by <code>dfu-util</code>.</li>
<li>The FC is put into bootloader mode</li>
<li>
<p><code>dfu-util</code> is invoked as:</p>
<pre><code> dfu-util -d 0483:df11 --alt 0 -s 0x08000000:force:leave -D inav_5.0.0_WINGFC.bin
</code></pre>
</li>
<li>
<p>The firmware is flashed and the FC reboots</p>
</li>
<li>The temporary bin file is removed</li>
</ul>
<p>Note that gcc <code>objcopy</code> is required to convert from <code>.hex</code> to <code>.bin</code> (as required by <code>dfu-util</code>).</p>
<h2 id="flashgo">flashgo<a class="headerlink" href="#flashgo" title="Permanent link">#</a></h2>
<p><code>flashgo</code> is a tool to download blackbox logs from on-board flash. If you're doing this on a VCP board, it will download much faster then the apparent baud rate indicates. If you're using a non-VCP board (i.e. F3 or earlier), then consider using <code>flash_dump.rb</code> which can  temporarily alter the baudrate to achieve faster rates using CLI (vice MSP) commands.</p>
<p><code>flashgo</code> is a replacement for the earlier <code>flashdl</code> tool.</p>
<pre><code>$ flashgo --help
Usage of flashgo [options] [device]
-dir string
    output directory ($(cwd) if not specified)
-erase
    erase after download
 -file string
    output file, auto-generated (bbl_YYYY-MM-DD_hhmmss.TXT) if not specified
 -info
    show flash info and exit
 -only-erase
    erase only and exit
 -test
    download whole flash regardess of used state

device is the FC serial device, which may be auto-dectected
</code></pre>
<h3 id="usage-examples">Usage Examples<a class="headerlink" href="#usage-examples" title="Permanent link">#</a></h3>
<h4 id="check-flash-usage">Check flash usage<a class="headerlink" href="#check-flash-usage" title="Permanent link">#</a></h4>
<pre><code>$ flashgo -info
Using /dev/ttyACM0
Firmware: INAV
Version: 5.0.0
Data flash 0 / 2097152 (0%)
</code></pre>
<h4 id="test-mode-download-whole-flash">Test mode (download whole flash)<a class="headerlink" href="#test-mode-download-whole-flash" title="Permanent link">#</a></h4>
<pre><code>$ flashgo -test
Using /dev/ttyACM0
Firmware: INAV
Version: 5.0.0
Entering test mode for 2097152b
Data flash 2097152 / 2097152 (100%)
Downloading to bbl_2022-05-22_113211.TXT
[▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇] 2.0MB/2.0MB 100% 0s
2097152 bytes in 40.2s, 52218.4 bytes/s
</code></pre>
<h4 id="check-flash-info">Check flash info<a class="headerlink" href="#check-flash-info" title="Permanent link">#</a></h4>
<pre><code>$ flashgo -info
Using /dev/ttyACM0
Unexpected MSP 108 (0x6c)
Firmware: INAV
Version: 5.0.0
Data flash 27674 / 2097152 (1%)
</code></pre>
<h4 id="download-to-auto-generated-file-name">Download to auto-generated file name<a class="headerlink" href="#download-to-auto-generated-file-name" title="Permanent link">#</a></h4>
<pre><code>$ flashgo
Using /dev/ttyACM0
Firmware: INAV
Version: 5.0.0
Data flash 27674 / 2097152 (1%)
Downloading to bbl_2022-05-22_114044.TXT
[▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇] 27.0KB/27.0KB 100% 0s
27674 bytes in 0.5s, 50838.4 bytes/s
</code></pre>
<h4 id="erase-the-flash-only-no-download">Erase the flash (only, no download)<a class="headerlink" href="#erase-the-flash-only-no-download" title="Permanent link">#</a></h4>
<pre><code>$ flashgo -only-erase
Using /dev/ttyACM0
Firmware: INAV
Version: 5.0.0
Erase in progress ...
Completed
</code></pre>
<h4 id="check-flash-info_1">Check flash info<a class="headerlink" href="#check-flash-info_1" title="Permanent link">#</a></h4>
<pre><code>$ flashgo -info
Using /dev/ttyACM0
Firmware: INAV
Version: 5.0.0
Data flash 46893 / 2097152 (2%)
</code></pre>
<h4 id="download-to-nominated-file-name">Download to nominated file name<a class="headerlink" href="#download-to-nominated-file-name" title="Permanent link">#</a></h4>
<pre><code>$ flashgo -file bbl_TEST.txt
Using /dev/ttyACM0
Firmware: INAV
Version: 5.0.0
Data flash 46893 / 2097152 (2%)
Downloading to bbl_TEST.txt
[▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇] 45.8KB/45.8KB 100% 0s
46893 bytes in 0.9s, 52290.6 bytes/s
</code></pre>
<h4 id="download-to-nominated-file-and-directory">Download to nominated file and directory<a class="headerlink" href="#download-to-nominated-file-and-directory" title="Permanent link">#</a></h4>
<pre><code>$ flashgo -file bbl_TEST.txt -dir /tmp/
Using /dev/ttyACM0
Firmware: INAV
Version: 5.0.0
Data flash 46893 / 2097152 (2%)
Downloading to /tmp/bbl_TEST.txt
[▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇] 45.8KB/45.8KB 100% 0s
46893 bytes in 0.9s, 52298.0 bytes/s
</code></pre>
<h4 id="download-to-auto-generated-file-name-and-nominated-directory-then-erase-flash">Download to auto-generated file name and nominated directory, then erase flash<a class="headerlink" href="#download-to-auto-generated-file-name-and-nominated-directory-then-erase-flash" title="Permanent link">#</a></h4>
<pre><code>$ flashgo  -dir /tmp/ -erase
Using /dev/ttyACM0
Firmware: INAV
Version: 5.0.0
Data flash 46893 / 2097152 (2%)
Downloading to /tmp/bbl_2022-05-22_114515.TXT
[▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇] 45.8KB/45.8KB 100% 0s
46893 bytes in 0.9s, 52291.9 bytes/s
Erase in progress ...
Completed
</code></pre>
<p>Note that in every case, the FC device node is auto-detected.</p>
<p>Note also that the download speed is approximately <strong>5</strong> times greater than one would expect from the nominal baud rate (115200 ~= 10800 bytes/sec).</p>
<h2 id="flash_dumprb">flash_dump.rb<a class="headerlink" href="#flash_dumprb" title="Permanent link">#</a></h2>
<p><code>flash_dump.rb</code> is another tool for downloading blackbox logs from on-board flash. Whereas <code>flashgo</code> uses MSP, flash_dump.rb uses CLI commands and is thus rather more fragile and requires that the FC firmware is compiled with <code>#define USE_FLASH_TOOLS</code> (<strong>which is not the default</strong>).</p>
<ul>
<li>It allows the temporary use of higher baud rates on USB (e.g. 921600).</li>
<li>If it fails, you may  have to reset the baud rate via the CLI, if the configurator is unable to connect &gt; 115200 baud.<pre><code>$ flash_dump.rb --help

flash_dump.rb [options] file
Download bb from flash
    -s, --serial-device=DEV
    -e, --erase
    -E, --erase-only
    -o, --output=FILE
    -b, --baud=RATE
    -B, --super-baud=RATE
    -?, --help                       Show this message
</code></pre>
</li>
</ul>
<p>Unlike <code>flashdl</code> which auto-detects serial ports, <code>flash_dump.rb</code> tries <code>/dev/ttyUSB0</code> and <code>/dev/ttyACM0</code>, or the device given with <code>-d</code>. The "super baud" rate must be specified to use a faster rate than the FC default:</p>
<pre><code>$ flash_dump.rb -B 921600
/dev/ttyUSB0
Changing baud rate to 921600
Found "serial 0 1 115200 38400 115200 115200"
setting serial 0 1 921600 38400 115200 115200
Reopened at 921600
Size = 1638400
read 1638400 / 1638400 100%    0s
Got 1638400 bytes in 18.8s 87268.8 b/s
Exiting
</code></pre>
<p>After the download has completed, the serial port is reset to the previously configured baud rate (typically 115200). Note the very high speed of the  download, 87268 bytes /sec; this is almost 9 times faster than the standard baud (and 9x the speed of using the configurator with a USB board).</p>
<p>Should the download fail and the board serial speed is not reset automatically, it will be necessary to manually reset UART1, possibly using <code>cliterm</code>.</p>
<p>So, had the above failed, it could be rescued by pasting in the "Found" line above:</p>
<pre><code>$ cliterm -b 921600
open /dev/ttyUSB0

Entering CLI Mode, type 'exit' to return, or 'help'

# serial 0 1 115200 38400 115200 115200

# save
Saving
Rebooting
</code></pre>
<h2 id="cliterm">cliterm<a class="headerlink" href="#cliterm" title="Permanent link">#</a></h2>
<p><code>cliterm</code> is a terminal program for interacting with the INAV CLI. Unlike alternative tools (<code>picocom</code>, <code>minicom</code> etc.), it will auto-detect the FC serial device, uses 115200 as the baud rate and, by default, automatically enters the CLI.</p>
<pre><code>    $ cliterm --help
    Usage:
      cliterm [OPTION?]  - cli tool

    Help Options:
      -h, --help                            Show help options

    Application Options:
      -b, --baud=115200                 baud rate
      -d, --device                      device
      -n, --noinit=false                noinit
      -m, --msc=false                   msc mode
      -g, --gpspass=false               gpspassthrough
      -p, --gpspass=false               gpspassthrough
      -f, --file                        file
      --eolmode=[cr,lf,crlf,crcrlf]     eol mode
</code></pre>
<ul>
<li>With <code>-g</code>, <code>-p</code>, the FC is put into GPS passthrough mode, in order to use tools like <code>ublox-cli</code> or <code>u-center</code> (sic).</li>
<li><code>-m</code>, <code>--msc</code> causes the FC to reboot in MSC (USB Mass Storage) mode.</li>
</ul>
<p>The options <code>-n</code> (don't enter CLI automatically) and <code>-m</code> may be useful when accessing other devices (for example a 3DR radio, HC-12 radio or ESP8266) in command mode.</p>
<p><code>cliterm</code> understands Ctrl-D as "quit CLI without saving". You should quit <code>cliterm</code> with Ctrl-C, having first exited the CLI in the FC (<code>save</code>, <code>exit</code>, Ctrl-D). Or after <code>save</code>, <code>exit</code>, <code>cliterm</code> will exit when the FC is rebooted, by seeing the tear-down of the USB device node.</p>
<h2 id="blackbox-analysis-and-diagnostics">Blackbox analysis and diagnostics<a class="headerlink" href="#blackbox-analysis-and-diagnostics" title="Permanent link">#</a></h2>
<p>mwptools has always included tools to simplify blackbox analysis. it seems to the author that it's often much easier to pre-process the output of <a href="https://github.com/iNavFlight/inav">INAV</a> <code>blackbox_decode</code> into a smaller dataset that addresses the specific problem rather than try and make sense of the mass of data in a blackbox log.</p>
<p>There are a few basic prerequisites for doing this analysis using the <a href="https://github.com/stronnag/mwptools">mwp</a> scripts:</p>
<ul>
<li>You have a recent version of INAV's <code>blackbox_decode</code></li>
<li>You have a <code>ruby</code> interpreter installed</li>
<li>You don't mind "getting your hands dirty" on the command line</li>
<li>If you want pretty graphs, have <code>gnuplot</code> installed; it's also possible to generate graphs ("charts") from spreadsheet applications (LibreOffice Calc, MS Excel).</li>
</ul>
<h3 id="worked-example">Worked example<a class="headerlink" href="#worked-example" title="Permanent link">#</a></h3>
<p>A user reported serious toilet-bowling / fly away on a large cine-octa with expensive VTX RF gear and camera gimbal. Two blackbox logs were provided, one with the RF and gimbal disabled, the other with them enabled (when the problem appears).</p>
<p>The logs were processed with the <code>mwptools/src/bbox-replay/inav-parse_bb_compass.rb</code>. This script:</p>
<ul>
<li>Decodes the log, down-sampling to 0.1s intervals (or user provided interval)</li>
<li>Extracts the GPS heading and the compass heading (via INAV's position estimator), the relevant blackbox fields being <code>GPS_ground_course</code> and <code>attitude[2]/10</code>.</li>
<li>Generates a calculated heading from adjacent GPS locations.</li>
<li>Generates a simplified CSV containing the down-sampled lines and required data only (including throttle and navigation state)</li>
<li>Generates a SVG graph.</li>
</ul>
<h4 id="script-usage">Script usage<a class="headerlink" href="#script-usage" title="Permanent link">#</a></h4>
<p>You need to run this from a shell (Linux / MacOS /FreeBSD terminal, Windows powershell or cmd).
<code>blackbox_decode</code> and (optionally) <code>gnuplot</code> need to be on the <code>PATH</code>.</p>
<pre><code>$ ./inav-parse_bb_compass.rb --help
inav-parse_bb_compass.rb [options] [file]
      --list-states
      --plot                       Generate SVG graph (requires 'gnuplot')
      --thr                        Include throttle value in output
  -o, --output=FILE                CSV Output (default stdout
  -i, --index=IDX                  BBL index (default 1)
  -t, --min-throttle=THROTTLE      Min Throttle for comparison (1000)
  -s, --states=a,b,c               Nav states to consider [all]
  -d, --delta=SECS                 Down sample interval (default 0.1s)
  -?, --help                       Show this message
</code></pre>
<h3 id="results-from-the-analysis">Results from the analysis<a class="headerlink" href="#results-from-the-analysis" title="Permanent link">#</a></h3>
<p>First, the good log (no VTX-RF or gimbal enabled):</p>
<pre><code>./inav-parse_bb_compass.rb --plot /tmp/LOG00001.TXT
INAV 4.1.0, states from 2.7.0
Log 1 of 1, start 00:49.654, end 06:33.615, duration 05:43.961

Statistics
Looptime            506 avg           14.9 std dev (2.9%)
I frames   21061  128.0 bytes avg  2696240 bytes total
P frames  315692   81.6 bytes avg 25753176 bytes total
H frames     164   10.0 bytes avg     1640 bytes total
G frames    1865   21.6 bytes avg    40300 bytes total
E frames       1    6.0 bytes avg        6 bytes total
S frames    4066   40.0 bytes avg   162637 bytes total
Frames    336753   84.5 bytes avg 28449416 bytes total
Data rate  979Hz  83359 bytes/s     833600 baud

29 frames failed to decode, rendering 181 loop iterations unreadable. 2897 iterations are missing in total (1466ms, 0.43%)
339649 loop iterations weren't logged because of your blackbox_rate settings (171980ms, 50.00%)

Graph in /tmp/LOG00001.TXT.csv.svg
</code></pre>
<p>We see some information, mainly the summary from <code>blackbox_decode</code> and notification of the resulting graph file.</p>
<p><img alt="Direction plot" src="../images/LOG00001.TXT.csv.svg" /></p>
<p>Looks OK, there's a few deviations between the GPS and position estimator, possibly a result of hard Acro mode manoeuvres.</p>
<p>Let's now look at the log with the VTX-RF and gimbal enabled:</p>
<pre><code>./inav-parse_bb_compass.rb --plot /tmp/LOG00008.TXT
...
 Graph in /tmp/LOG00001.TXT.csv.svg
</code></pre>
<p>Note the difference</p>
<p><img alt="Direction plot" src="../images/LOG00008.TXT.csv.svg" /></p>
<p>Something in generating enough interference to cause the heading / position estimator <code>attitude[2]</code> to essentially flat-line.</p>
<p>So now we have concrete evidence of the problem, the next steps would be for the pilot to repeat the exercise enabling just one of the suspect devices to identify the actual cause of the problem and then rectify it:</p>
<ul>
<li>Somehow isolate the device</li>
<li>Replace the device with a better shielded substitute</li>
<li>Move the GPS / compass further away (might not be so easy)</li>
</ul>
<h3 id="similar-tools">Similar tools<a class="headerlink" href="#similar-tools" title="Permanent link">#</a></h3>
<p>PH unstable altitude is often caused by excessive vibrations or inadequately protected (open cell foam) barometer. <code>mwptools/src/bbox-replay/inav_gps_alt.rb</code> will generate a similar graph of baro v. GPS v. position estimator elevations.</p>
<ul>
<li>GPS and baro correlate, position estimator is off, most likely vibrations</li>
<li>GPS and baro don't correlate. Probably lack of baro protection (or GPS interference from VTX).</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2014 - 2025 <a href="https://github.com/stronnag/mwptools">Jonathan Hudson</a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>